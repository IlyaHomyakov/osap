<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>

<Head>
<Meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<Title>Электронный ресурс по учебной дисциплине ОСАПр. Работа с файлами: ввод/вывод</Title>
<Meta Name="Description" http-equiv="description" Content="Электронный ресурс по учебной дисциплине ОСАПр. Работа с файлами: ввод/вывод">
<Link Rel="stylesheet" Type="text/css" Href="../../../Оболочка/acad.css">

<Script>hljs.initHighlightingOnLoad();</Script>

<Script Language="JavaScript">
<!--
	function mOver(num) {if (document.images) {document.images['link'+num].src=eval('active'+num+'.src');}}
	function mOut(num) {if (document.images) {document.images['link'+num].src=eval('normal'+num+'.src');}}
//-->
</Script>
</Head>

<Body Bgcolor=#E6E6E6 TopMargin=1 LeftMargin=1 MarginWidth=0 MarginHeight=0 >
<div class=max>
<Script Language="JavaScript"><!--
if (document.images) {
	normal1=new Image(190,29);normal1.src="../../../Оболочка/images//01a.gif";
	active1=new Image(190,29);active1.src="../../../Оболочка/images//01p.gif";
	normal2=new Image(190,29);normal2.src="../../../Оболочка/images/02a.gif";
	active2=new Image(190,29);active2.src="../../../Оболочка/images/02p.gif";
	normal3=new Image(190,29);normal3.src="../../../Оболочка/images//03a.gif";
	active3=new Image(190,29);active3.src="../../../Оболочка/images//03p.gif";
	normal4=new Image(159,46);normal4.src="../../../Оболочка/images//09a.gif";
	active4=new Image(159,46);active4.src="../../../Оболочка/images//09p.gif";
	normal5=new Image(159,54);normal5.src="../../../Оболочка/images//10a.gif";
	active5=new Image(159,54);active5.src="../../../Оболочка/images//10p.gif";
	normal7=new Image(190,29);normal7.src="../../../Оболочка/images//7a.gif";
	active7=new Image(190,29);active7.src="../../../Оболочка/images//7p.gif";
	normal11=new Image(170,25);normal11.src="../../../Оболочка/images//02_1a.gif";
	active11=new Image(170,25);active11.src="../../../Оболочка/images//02_1p.gif";
	normal12=new Image(170,19);normal12.src="../../../Оболочка/images//02_2a.gif";
	active12=new Image(170,19);active12.src="../../../Оболочка/images//02_2p.gif";
	normal13=new Image(170,19);normal13.src="../../../Оболочка/images//02_3a.gif";
	active13=new Image(170,19);active13.src="../../../Оболочка/images//02_3p.gif";
	normal24=new Image(170,19);normal24.src="../../../Оболочка/images//04a.gif";
	active24=new Image(170,19);active24.src="../../../Оболочка/images//04p.gif";
	normal25=new Image(170,19);normal25.src="../../../Оболочка/images//05a.gif";
	active25=new Image(170,19);active25.src="../../../Оболочка/images//05p.gif";
	normal26=new Image(170,19);normal26.src="../../../Оболочка/images//06a.gif";
	active26=new Image(170,19);active26.src="../../../Оболочка/images//06p.gif";
	normal14=new Image(170,19);normal14.src="../../../Оболочка/images//l1_a.gif";
	active14=new Image(170,19);active14.src="../../../Оболочка/images//l1_p.gif";
	normal15=new Image(170,19);normal15.src="../../../Оболочка/images//z_a.gif";
	active15=new Image(170,19);active15.src="../../../Оболочка/images//z_p.gif";
	normal16=new Image(170,19);normal16.src="../../../Оболочка/images//l2_a.gif";
	active16=new Image(170,19);active16.src="../../../Оболочка/images//l2_p.gif";
	normal17=new Image(170,19);normal17.src="../../../Оболочка/images//z_a.gif";
	active17=new Image(170,19);active17.src="../../../Оболочка/images//z_p.gif";
	normal18=new Image(170,19);normal18.src="../../../Оболочка/images//l3_a.gif";
	active18=new Image(170,19);active18.src="../../../Оболочка/images//l3_p.gif";
	normal19=new Image(170,19);normal19.src="../../../Оболочка/images//z_a.gif";
	active19=new Image(170,19);active19.src="../../../Оболочка/images//z_p.gif";
	normal20=new Image(170,19);normal20.src="../../../Оболочка/images//l4_a.gif";
	active20=new Image(170,19);active20.src="../../../Оболочка/images//l4_p.gif";
	normal21=new Image(170,19);normal21.src="../../../Оболочка/images//z_a.gif";
	active21=new Image(170,19);active21.src="../../../Оболочка/images//z_p.gif";
	normal27=new Image(170,19);normal27.src="../../../Оболочка/images/15a.gif";
	active27=new Image(170,19);active27.src="../../../Оболочка/images/15p.gif";
}
//-->
</Script>

<Left>
<A Name="Top"></A>
<Table Border=0 Width=100% CellSpacing=0 CellPadding=0>
<Tr>
 <Td BackGround=../../../Оболочка/images/bg01.gif Width=190 Height=91 name="link19">&nbsp;</Td>
 <Td Rowspan=2 BackGround=../../../Оболочка/images/bg02_acad.gif Height=120 Valign=Bottom style="background-repeat:no-repeat;">

<Table BackGround=../../../Оболочка/images/raspor.gif Border=0 CellSpacing=0 CellPadding=0>
 <Tr>
  <Td Width=230></Td>
  <Td><P Class=h6>AutoLISP<Br><Img Src=../../../Оболочка/images/raspor.gif Width=1 Height=26></P></Td>
 </Tr>
</Table>

</Td></Tr>
<Tr>
 


<Td BackGround=../../../Оболочка/images/bg03.gif>
 <A Href=../../../Программа/!rabprog.html onMouseOver="mOver(26)" onMouseOut="mOut(26)"><Img Src=../../../Оболочка/images/06a.gif Width=190 Height=29 Border=0 
Alt="Рабочая программа" name="link26"></A><Br></Td>

</Tr>
<Tr>
 <Td BackGround=../../../Оболочка/images/bg09.gif Valign=Top>

<Table Border=0 CellSpacing=0 CellPadding=0>
<Tr><Td BackGround=../../../оболочка/images/bg03.gif Valign=Top>
	<A Href=../../../Теория/!lekcii.html onMouseOver="mOver(7)" onMouseOut="mOut(7)"><Img Src=../../../оболочка/images/7a.gif Width=190 Height=29 Border=0 
Alt="Лекции" name="link7"></A><Br>
 </Td>
 <Tr><Td BackGround=../../../оболочка/images/bg04.gif Width=190 Valign=Top>
 <a href="../../!zadanie.html"> <Img Src=../../../оболочка/images/8p.gif Border=0 Width=190 Height=29 Alt="Лабораторные работы"></a><Br></Td>
<Tr><Td BackGround=../../../оболочка/images/bg05_1.gif Width=190 Valign=Top>
  <A href="../lb1/!acad.html" onMouseOver="mOver(14)" onMouseOut="mOut(14)"><Img Src=../../../оболочка/images/l1_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 1" name="link14"></A><Br></Td></Tr>
<Tr><Td BackGround=../../../оболочка/images/bg06.gif Width=190 Height=36 Valign=Top>
   <A href="../lb1/laba1.html"  onMouseOver="mOver(15)" onMouseOut="mOut(15)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 1" name="link15"></A><Br>
  <A href="../lb2/!mechanic.html" onMouseOver="mOver(18)" onMouseOut="mOut(18)"><Img Src=../../../Оболочка/images/l3_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 2" name="link18"></A><Br>
<A  href="../lb2/laba2.html" onMouseOver="mOver(19)" onMouseOut="mOut(19)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 2" name="link19"></A><Br>
  <A href="../lb2/!mechanic.html" onMouseOver="mOver(20)" onMouseOut="mOut(20)"><Img Src=../../../Оболочка/images/l4_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 3" name="link20"></A><Br>
<A href="../lb3/laba3.html"1 onMouseOver="mOver(21)" onMouseOut="mOut(21)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 3" name="link21"></A><Br>
 <A href="../lb4/!lisp.html" onMouseOver="mOver(16)" onMouseOut="mOut(16)"><Img Src=../../../Оболочка/images/l2_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 4" name="link16"></A><Br>
<A  href="../lb4/laba4.html" onMouseOver="mOver(17)" onMouseOut="mOut(17)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 4" name="link17"></A><Br>
  <Img Src=../../../Оболочка/images/bg07.gif Width=190 Height=23><Br></Td></Tr>
 
 <Tr><Td BackGround=../../../оболочка/images/bg03.gif Valign=Top>
   <A Href=../../../Заочнику/!zaochnoe.html onMouseOver="mOver(27)" onMouseOut="mOut(27)"><Img Src=../../../Оболочка/images/15a.gif Width=190 Height=29 Border=0  Alt="Заочнику" name="link27"></A><Br>
  <A Href=../../../Контроль_знаний/!samocontrol.html onMouseOver="mOver(25)" onMouseOut="mOut(25)"><Img Src=../../../оболочка/images/05a.gif Width=190 Height=29 Border=0 
Alt="Самоконтроль" name="link25"></A><Br>
	 <Img Src=../../../оболочка/images/bg08.gif Width=190 Height=13><Br>
</Table></Td>
 <Td Valign=Top>
<P><Br></P>

<Center>
<Table Border=0 CellPadding=0 CellSpacing=0 Width=95%><Tr><Td>

<Br>
<Table Border=0 CellPadding=0 CellSpacing=0>
<Tr><Td Bgcolor=#000000><Img Src=../../../оболочка/images/raspor.gif Height=2></Td>
<Tr><Td Valign=Center Height=30><span Class=h1>Работа с файлами: ввод/вывод</span></Td></Tr>
<Tr><Td Bgcolor=#000000><Img Src=../../../оболочка/images/raspor.gif Height=2></Td></Tr>
</Table></Center><Br>


<P>Средства работы с файлами в AutoLISP не слишком развиты, однако для большинства повседневных нужд этого вполне достаточно. При работе с файлами, как и в других языках программирования, следует придерживаться следующей схемы: сначала файл необходимо открыть, при этом будет создана специальная файловая переменная (дескриптор файла), затем можно выполнять операции чтения/записи, после чего файл должен быть закрыт.</P>
<pre><code> (open имя_файла режим)</code></pre>

<P>Эта функция открывает файл. Возвращается дескриптор файла.</P>
<P>Функции ввода/вывода работают не с именами файлов, а с дескрипторами файлов, определяющими не только собственно файл, но и режим доступа и различные другие системные параметры. "Открыть файл" - значит подготовить дескриптор файла к использованию его функциями ввода/вывода AutoLISP. Поэтому возвращаемое функцией OPEN значение дескриптора файла должно присваиваться некоторой файловой переменной, например:</P>
<pre><code> setq f (open "file.ext" "r"))</code></pre>

<P>Здесь переменная f - дескриптор файла file.ext, открытого для чтения. Флаг чтения или записи&nbsp;- это, как и имя файла, строковая константа, состоящая из одной буквы, которая должна быть набрана на нижнем регистре. Допустимые значения флага чтения/записи:</P>

<Center>
<Table Border="1" CellPadding="2" CellSpacing="1">
 <Tr BgColor="#D1D6E9">
 <Td><P Class=tcb>Режим</P></Td>
 <Td><P Class=tcb>Описание</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tcb>r</P></Td>
 <Td><P Class=tl>Открыть файл для чтения. Если файл с указанным именем не существует, возвращается nil</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tcb>w</P></Td>
 <Td><P Class=tl>Открыть файл для записи. Если файл с указанным именем не существует, создается и открывается новый файл. Если такой файл уже существует, то хранящиеся в нем данные будут утеряны</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tcb>a</P></Td>
 <Td><P Class=tl>Открыть файл для дозаписи. Если файл с указанным именем не существует, возвращается nil</P></Td>
</Tr>
</Table></Center>

<P>Если аргумент имя_файла указывает на несуществующий файл в режимах "w" и "а", то он создаётся. Если указано неполное имя (без пути), то файл ищется в текущем каталоге и по списку путей файлов поддержки. Имя файла может включать в себя путь (имена надкаталогов). Можно пользоваться обратной косой чертой вместо прямой косой черты. (Напомним: чтобы ввести в строку одну обратную косую черту, следует напечатать две обратных косых черты: "\\").</P>
<pre><code> (setq f (open "D:\\Lisp\\Dim.txt" "w")) возвращает #<file "Dini.txt"> (дескриптор файла)</code></pre>
<Br>
<pre><code> (close дескриптор_файла)</code></pre>

<P>Эта функция завершает все процессы, инициированные функцией OPEN. После закрытия файла использование дескриптор_файла невозможно, хотя сам дескриптор файла не изменяется. Использование функции close обязательно: все открытые файлы должны быть закрыты, иначе данные могут быть потеряны.</P>
<pre><code> Пример: (close f) возвращает ni</code></Pre>
<Br>

<pre><code> (find file имя_файла)</code></pre>

<P>Эта функция отыскивает файл имя_файла (т. е. возвращает полное имя файла по указанному основному имени файла) в каталогах, хранящих файлы AutoCAD. Сначала просматривается текущий каталог, затем каталог, в котором хранится текущий рисунок, и, наконец, каталог, имя которого записано в переменной среды ACAD. Такое полное имя можно передавать функции open.</P>
<pre><code> (read строка)</code></pre>

<P>Эта функция возвращает первый список или атом из данной строки, причем строка не должна содержать пробелов, за исключением, находящихся в списке. READ возвращает аргументы, задавая им соответствующий тип данных.</P>
<pre><code> (read-char  [дескриптор_файла])</code></pre>

<P>Считывает единичный символ из буфера клавиатуры или из открытого файла, заданного аргументом дескриптор_файла. Возвращается целое число - код ASCII считанного символа. Если дескриптор_файла не задан и буфер клавиатуры пуст, функция ожидает ввода символа (пользователь должен ввести что-либо с клавиатуры, заканчивающееся RETURN). Например, если в ответ на запрос функции read-char пользователь введет с клавиатуры "АВС" и завершит ввод нажатием клавиши RETURN, то функция read-char возвратит код 65 (код ASCII латинской буквы '"А"). При следующих трех обращениях к read-char она возвратит соответственно 66, 67 и 10 (код перевода строки). Если последует пятый вызов функции read-char, она снова будет ожидать ввода. Для унификации работы программ на AutoLISP в различных операционных системах функция read-char возвращает при чтении конца строки один символ с кодом 10.</P>
<pre><code> (read-line [дескриптор_файла])</code></pre>

<P>Данная функция считывает строку символов с клавиатуры или из открытого файла, заданного аргументом дескриптор_файла. Возвращается считываемая строка. Если достигнут конец файла, возвращается nil.</P>
<pre><code> (write-char число [дескриптор_файла])</code></pre>

<P>Эта функция записывает один символ на экран или в открытый файл, заданный аргументом дескриптор_файла. Здесь число - код ASCII символа и является возвращаемым функцией значением. Функция write-char не может записать в файл символ NUL (ASCII - код 0).</P>
<pre><code> (write-line строка [дескриптор_файла])</code></pre>

<P>Эта функция записывает строковую константу строка на экран или в открытый файл, заданный аргументом дескриптор_файла. Она возвращает строку, взятую в кавычки, и опускает кавычки при записи в файл.</P>
<pre><code> (prin1 [выражение[дескриптор_файла]])</code></pre>

<P>Данная функция выводит выражение на экран или в открытый файл, заданный аргументом дескриптор_файла, без пробелов и переходов на новую строку и возвращает выражение. Выражение может быть любым, а не только строковой константой. Если выражение - строковая константа, включающая управляющие символы, то они интерпретируются следующим образом:</P>

<Center>
<Table Border="1" CellPadding="2" CellSpacing="1">
 <Tr BgColor="#D1D6E9">
 <Td><P Class=tcb>Символ</P></Td>
 <Td><P Class=tcb>Значение</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tl>\\\</P></Td>
 <Td><P Class=tl>символ \</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tl>\"</P></Td>
 <Td><P Class=tl>символ "</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tl>\е</P></Td>
 <Td><P Class=tl>символ escape-последовательности</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tl>\n</P></Td>
 <Td><P Class=tl>переход на новую строку</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tl>\r</P></Td>
 <Td><P Class=tl>возврат каретки</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tl>\t</P></Td>
 <Td><P Class=tl>табуляция</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tl>\nnn</P></Td>
 <Td><P Class=tl>символ с восьмеричным кодом nnn</P></Td>
</Tr>
</Table></Center>

<P>При использовании PRIN1 без аргументов в качестве последнего выражения определяемой пользователем функции, то после завершения работы функции все, что появится на экране, - это пустая строка.</P>
<pre><code> (princ [выражение [дескриптор_файла]])</code></pre>

<P>Данная функция в отличие от предыдущей предназначена для печати управляющих символов в выражении без расширения, т. е. так, как они могли считываться функциями типа READ-LINE.</P>
<pre><code> (print [выражение [дескриптор_файла]])</code></pre>

<P>Данная функция в отличие от предыдущей предназначена для печати выражения с новой строки с последующим пробелом.</P>
<pre><code> (terpri)</code></pre>

<P>Данная функция печатает новую строку на экране и возвращает nil. Она не используется для ввода/вывода файлов.</P>
<pre><code> (prompt сообщение)</code></pre>

<P>Данная функция высвечивает сообщение в зоне подсказок экрана и возвращает nil. Сообщение - это строка символов.</P>



<Hr Width="90%" Color="#7685C6" Align="Right">
<Br>


<p class="h3">Функция findfile
</p>
<p>Ищет файл по имени (краткому или полному)(findfile <файл>)
</p>
<p>Если аргумент содержит имя файла без полного пути, то поиск выполняется сначала в текущем каталоге (обычно это папка Мои документы текущего пользователя), а затем по стандартным для системы AutoCAD путям поиска файлов. Возвращается полное имя файла, если файл найден, или nil — в противном случае. Аргумент должен быть текстовой строкой.</p>
<p class="h55"> Примеры (для версий 2006):
</p>
<pre><code> (findfile "Support") возвращает "d: WAutoCAD 2006\\Support"
 (findfile  "acad.cui") возвращает 
"С:\\Documents and Settings\\ ... \\Application Data\\Autodesk\\AutoCAD 2006\\R16.2\\enu\\support\\acad.cui"</code></pre>

<p class="h3">Функция read-line
</p>
<p>Читает строку из файла с заданным дескриптором.
(read-line [<Дескриптор>])</p>
<p>Если аргумент <дескриптор> опущен, то выполняется чтение строки с клавиатуры
(строка должна закончиться нажатием клавиши <Enter>).</p>
<p>Возвращаемое  значение — текстовая  строка, прочитанная  из файла или
с клавиатуры.</p>
<p>Дескриптор содержит внутри себя информацию о текущей записи (т. е. той строке, с которой будет выполняться очередная операция чтения или записи). Сразу же после выполнения функции open дескриптор указывает на первую запись файла.
</p><p>Пример применения функции read-line
</p>
<p class="h3">Функция write-line
</p>
<p>Записывает строку, заданную аргументом <строка>, в файл с дескриптором, заданным аргументом <дескриптор>. Если аргумент <дескриптор> опущен или равен nil, то система AutoCAD выводит строку на экран. При записи строка, заданная аргументом <строка>, заносится в файл (или выводится на экран) без ограничивающих ее двойных кавычек.</p>
<pre><code> (write-line <строка> [<дескриптор>])</code></pre>
<p>Возвращаемое значение — значение аргумента <строка>. 
</p><p class="h55">Пример:</p>
<pre><code> (write-line "Плазовая книга" fo) возвращает "Плазовая книга"</code></pre>
<Br>

<Table Border=0 CellPadding=0 CellSpacing=0 Width=95%>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#800000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>

<Tr><Td Valign=ToP><P Class=pr>Замечание:&nbsp;&nbsp;</P></Td>

<Td Valign=Center><P Class=prt> Если выполнить одно только выражение, приведенное в примере, с выводом на экран, то в командной строке к тексту без кавычек добавится еще возвращаемое значение — тот же текст в кавычках.</P></Td></Tr>

<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#800000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr></Table>
<Br>
<pre><code> Функция princ</code></pre>
<p>Записывает значение аргумента <аргумент>, который может быть любым выражением LISP (а также числом, списком, строкой, именем примитива и т. д.), в виде текстовой строки в файл с заданным дескриптором.</p>
<pre><code> (princ [<аргумент> [<дескриптор>]])</code></pre>
<p>Если аргумент <дескриптор> опущен или равен nil, то <аргумент> выводится на экран. Если <аргумент> — строка, то при записи она заносится в файл (или выводится на экран) без ограничивающих ее двойных кавычек.</p>
<p>Возвращаемое значение — значение аргумента <аргумент> (для вещественных чисел выводятся по шесть значащих цифр). Если опущены оба аргумента, то функция осуществляет так называемый тихий выход, т. е. не возвращает никакого значения, в том числе nil (чтобы не загромождать командную строку ненужными данными и сообщениями).
</p>
<p class="h55">Примеры:
</p>
<pre><code> (princ ' (4.5678123  11.1) fo) пишет в файл и возвращает (4.56781  11.1)
 (prime "Мороз" fo) пишет в файл мороз и возвращает "мороз"
 (princ) не возвращает ничего</code></pre>
<p class="h3">Функция prin1
</p>
<p>Функция аналогична princ. Но если <аргумент> — строка, то при записи она заносится в файл (или выводится на экран) с ограничивающими двойными кавычками; специальные символы (обратная косая черта, кавычки, конец строки и т. п.) предваряются обратной косой чертой.</p>
<pre><code> prin1 [<аргумент> [<дескриптор>]])</code></pre>
<p>Возвращаемое значение — значение аргумента <аргумент>. Если опущены оба аргумента, то функция prin1 тоже осуществляет тихий выход.
</p>
<p class="h55">Примеры:
</p>
<pre><code> (prin1 '(4.5678123   11.1) fо) ПИШеТ В файл И ВОЗВращаеТ (4.56781   11.1)
 (prin1 "Мороз и солнце" fo) пишет в файл и возвращает "мороз и солнце"
 (prin1) не возвращает ничего</code></pre>

<p class="h3">Функция print
</p>
<p>Функция аналогична prin1, но при выводе добавляет перед значением аргумента <аргумент> символ конца строки предыдущей записи, а после значения — пробел.
<pre><code> (print [<аргумент> [<дескриптор>]])</code></pre>
<p>Возвращаемое значение — вычисленное значение аргумента <аргумент>. Функция тоже осуществляет тихий выход, если оба аргумента опущены.
</p><p class="h55">Примеры:</p>
<pre><code> В (print '(4.5678123 11.1) fo) пишет в файл \n(4.56781 11.1)_ и возвращает (4.56781 11.1) 
(перевод строки обозначен символами \n, а пробел
 в конце -символом подчеркивания)
 (print "Мороз" fo) пишет в файл \n"Мороз"_ и возвращает "Мороз"  (print) не возвращает ничего</code></pre>

<p class="h3">Функция read-char
</p>
<p>Читает символ из файла. Если аргумент не задан, то выполняет чтение символа из буфера клавиатуры.
<pre><code> (read-char [<дескриптор>])</code></pre>
<p>Возвращает целое число  -   код прочитанного символа (аналогично функции
ascii). При чтении из буфера клавиатуры — для клавиши <Enter> функция возвращает 10.
</p>


<p class="h3">Функция write-char
</p>
<p>Записывает буквенно-цифровой символ с заданным кодом в файл.
<pre><code> (write-char <код> [<дескриптор>])</code></pre>
<p>Если аргумент <дескриптор> не задан, то выводит символ на экран.
Возвращаемое значение — целое число (код выведенного символа). Невозможно
с помощью данной функции записать символ с кодом 0.</p>
<p class="h55">Примеры:
</p>
<pre><code> (write-char 50) возвращает 50 (предварительно на экран выводится цифра 2, т. к. буквенно-цифровой символ "2" имеет код 50, а затем в командную строку
 выводится возвращаемое значение; поэтому кажется, что возвращено значение 250, а не 50)
 (setq syn (write-char 40 fo)) возвращает 40 (если прочитать значение переменной syn, то оно тоже будет равно 40)</code></pre>

<p class="h3">Функция prompt
</p>
<p>Выводит сообщение на экран (если используется установка системы AutoCAD на двухэкранный вычислительный комплекс, то выводит сообщение на оба экрана). Чтобы избежать этого дублирования, можно пользоваться для вывода сообщений функцией princ.</p>
<pre><code> (prompt <сообщение>)</code></pre>
<p>Аргумент — текстовая строка. Возвращаемое значение — nil. 
</p><p class="h55">Пример:</p>
<pre><code> (prompt "Новая тема") возвращает nil</code></pre>

<p class="h3">Функция alert
</p>
<p>Позволяет вывести на экран диалоговое окно с сообщением системы AutoCAD, (alert 
<сообщение>)</p>
<p>Аргумент — текстовая строка. Возвращаемое значение - nil.
</p>
<p>Максимальная длина строки <сообщение> зависит от многих вещей (в частности, от платформы) и может быть установлена пользователем самостоятельно. В случае превышения допустимой длины AutoCAD обрезает сообщение. При необходимости вывести сообщение в несколько строк нужно использовать знак КОНЦА строки ("\n").</p>
<p class="h55">Пример:	
</p>
<pre><code> (setq lines (strcat "Я вас любил: любовь еще, быть может, 
\n" "В душе моей угасла Не совсем, \nНо пусть она вас больше " "не тревожит;\nЯ не хочу
 печалить вас ничем.")) (alert lines)</code></pre>
<p class="h3">Функция terpri
</p>
<p>Переводит курсор экрана на новую строку (очередное сообщение будет выводиться с начала следующей строки).
<pre><code> (terpri)</code></pre>
<p>Возвращаемое значение — nil.
Фактически является аналогом (princ "\n"), но с другим возвращаемым значением.</p>

<p class="h3">Функция vl-directory-flles
</p>
<p>Выводит список с именами файлов и палок, расположенных внутри указанной папки.
<pre><code> (vl-directory-flles [<папка> «образец <флаг> ])</code></pre>
<p>Аргументы:  — текстовая строка (имя палки (каталога), из которой нужно распечатать список с именами файлов и папок); <образец>    текстовая строка
</p> 
<p>(DOS - шаблон для выбора имей файлов); <ФПАГ> - целое число (флаг управления выводом имен палок). Если аргумент <папка> равен "" или nil или опушен, то в качестве рассматриваемой палки принимается текущий каталог. Если аргумент <образец> опущен или задан равным nil, в качестве его значения принимается "*.*"
Аргумент <флаг> может принимать только три значения:</p>
<p class="h5">-1 — выводить только имена палок;<br>
	0 — выводить имена и файлов, и папок;<br>
	1 — выводить только имена файлов.</p>
<p>По умолчанию в качестве значения аргумента <флаг> принимается 0.
</p>
<p>Возвращаемое значение — список с именами найденных файлов и папок или nil, если по заданному шаблону и флагу ничего не найдено.
</p><p class="h55">Примеры:</p>
<pre><code> (vl-directory-files "d:\\AutoCAD 2006" "acad.** 1) возвращает ("acad.exe"
 (vl-directory-files) возвращает ("." ".." ...) (список оборван) — список файлов и палок текущего каталога (вероятнее всего, папки Мои документы
 текущего пользователя)</code></pre>

<p class="h3">Функция vl-file-copy
</p>
<p >Копирует содержимое файла-источника в целевой файл. Если целевой файл существует, то либо копирование не выполняется, либо содержимое файла-источника дописывается в конец целевого файла.</p>
<pre><code> (vl-file-copy <источник><цель> [<добавление>])</code></pre>
<p>Аргументы: <источник> — текстовая строка (имя файла-источника, т. е. файла, из которого выполняется копирование); <цель> — текстовая строка (имя целевого файла, т.е. файла, в который выполняется копирование); <добавление> — признак, разрешающий добавление информации в конец целевого файла, если он существовал до операции копирования (если аргумент <добавлеиие> задан и не равен nil, то дописывание разрешено; иначе генерируется сообщение об ошибке).
Если в аргументе <источник> имя файла указано без пути, то файл ищется по путям поиска файлов поддержки. То же относится к поиску или созданию файла, указанного в аргументе <цель>.</p>
<p>Возвращаемое значение — целое число (количество байтов) при успешном выполнении копирования. При ошибке возвращается nil.
</p> 
<p>Причинами ошибки могут быть, например, такие ситуации:
</p>
<p class="h5">	не существует файл-источник (или в качестве имени файла-источника задано имя папки);<br>
	целевой файл существует, но добавление в него не разрешено; ¦ сбой при чтении файла-источника;<br>
 сбой при записи (например, целевой файл защищен от записи); ¦ совпадают имена файла-источника и целевого файла. </p>
<p class="h55">Примеры:
</p>
<pre><code> (Yi-file-copy "acad.lsp"|; "acadl.lsp") возвращает nil (файл-источник не найден)
 (vl-file-copy "dim.txt" "dimdup.txt") может вернуть 28</code></pre>

<p class="h3">Функция vl-file-delete 
</p>
<p>Удаляет файл с заданным именем.
<pre><code> (vl-file-delete <файл>)</code></pre>
<p>Аргумент — текстовая строка с именем файла.
Возвращаемое значение — т, если удаление выполнено; nil, если удаление не выполнено.</p>
<p class="h55">Пример (продолжение второго примера из предыдущего раздела):
</p>
<pre><code> (vl-file-delete "dimdup.txt") возвращает T</code></pre>

<p class="h3">Функция vl-file-directory-p
</p>
<p>Проверяет, является ли имя, указанное в качестве аргумента, именем папки.
</p>
<pre><code> (vl-file-directory-p <иия>) Аргумент — текстовая строка.</code></pre>
<p>Возвращаемое значение — т, если аргумент указывает имя папки, и nil — в остальных случаях.
Бели аргумент <имя> не содержит полного пути к файлу, то проверяется только текущий каталог (чаще всего — папка Мои документы текущего пользователя).</p>
<p class="h55">Примеры:
</p>
<pre><code> (vl-file-directory-p "Мои рисунки") возвращает  Т
 (vl-file-directory-p  "Help") возвращает nil</code></pre> 
  
<p class="h3">Функция vl-file-rename
</p>
<p>Переименовывает файл или папку.
<pre><code> (vl-f ile-rename <старое> <новое>)</code></pre>
<p>Аргументы — текстовые строки.
Возвращаемое значение — т, если переименование выполнено, и nil, если переименование невозможно.
Если аргумент <старое> не содержит полного пути к файлу, то переименовываемый файл (папка) ищется только в текущем каталоге.</p>
<p class="h55">Пример:
</p>
<pre><code> (vl-f ile-rename "Help.txt" "Help2.txt") возвращает т, если в рабочем каталоге 
найдены файл или папка с именем "Help.txt" и переименование возможно</code></pre>

<p class="h3">Функция vl-file-size
</p>
<p>Вычисляет размер файла в байтах.
<pre><code> (vl-file-size <имя>)</code></pre>
<p>Аргумент — текстовая строка.
Возвращаемое значение — целое число (размер файла в байтах). Если указан несуществующий файл или аргумент является именем папки, то возвращается nil.
Если аргумент <имя> не содержит полного пути к файлу, то анализируемый файл ищется только в текущем каталоге.</p>
<p class="h55">Пример:
</p>
<pre><code> (vl-file-size "dim.txt") возвращает 28</code></pre>

<p class="h3">Функция vl-file-systime
</p>
<p>Вычисляет дату и время последней модификации файла.</p> <p class="h5">(vl-file-systime 
<имя>)</p>
<p>Аргумент — текстовая строка с именем файла.
</p><p>Возвращаемое значение — список из восьми целочисленных элементов:<br>
 год;	<br>
 часы;<br>
 месяц;	   <br>
минуты;<br>
 день недели;<br>
 секунды;<br>
 день месяца<br>
 миллисекунды</p>
<p>В качестве дня недели возвращается его порядковый номер (0— воскресенье, 1 — понедельник, 2 — вторник и т. д.).
</p><p class="h55">Пример:</p>
<pre><code> (vl-file-systime "dim.txt") может вернуть (2006 1 3 4  21  3  55 421), 
что означает 4 января 2006 года, 3-й день недели (среда), 21 час 3 мин. 55,421 сек.</code></pre>

<p class="h3">Функция vl-filename-base
</p>
<p>Выделяет имя файла, без расширения и пути.
<pre><code> (vl-filename-base <имя>)</code></pre>
<p>Аргумент — текстовая строка с полным или кратким именем файла.
Возвращаемое значение — текстовая строка с именем файла (без расширения и пути).
Функция не проверяет существования файла. </p>
<p class="h55">Пример:
</p>
<pre><code> (vl-filename-base "d:\\Cartoon\\Change\\v502.prn") возвращает "v502"</code></pre>

<p class="h3">Функция vl-filename-directory
</p>
<p>Выделяет путь из полного имени файла,
<pre><code> (vl-filename-directory <имя>)</code></pre>
</p>
<p>Аргумент — текстовая строка с именем файла. Возвращаемое значение — строка (путь к файлу).
Функция не проверяет существования файла. Удобно использовать ее в паре с функцией findfile, возвращающей полное имя файла.</p>
<p class="h5">Примеры:
</p>
<pre><code> (vl-filename-directory "d: \\Cartoon\\Change\\v502 .prn") возвращает "d: \\Cartoon\\Change"
  (vl-filename-directory "make.exe") возвращает</code></pre>

<p class="h3">Функция vl-filename-extension
</p>
<p>Выделяет расширение из имени файла,
<pre><code> (vl-filename-extension <имя>)</code></pre>
</p>
<p>Аргумент — текстовая строка с именем файла.
Возвращаемое значение — текстовая строка с расширением файла, начинается с точки. Если имя файла не содержит расширения, то возвращается nil.</p>
<p class="h55">Примеры:
</p>
<pre><code> (vl-filename-extension "d:\\Cartoon\\Change\\v502.prn") возвращает ".prn"
	(vl-filename-extension "acad.lsp") возвращает ".lsp"
	(vl-filename-extension "acad") возвращает nil</code></pre>

<p class="h3">Функция vl-filename-mktemp
</p>
<p>Вычисляет уникальное (т. е. не совпадающее с именами существующих файлов) имя для временного файла.
</p>
<pre><code> (vl-filename-mktemp [<образец> [<папка> [<расширение>]]])</code></pre>
<p>Аргументы: <образец> — образец префикса, используемого при построении имени временного файла; <папка> — папка, в которой нужно разместить временный файл; <расширение> — расширение, с которым нужно сформировать имя временного файла. Все аргументы — текстовые строки.
Возвращаемое значение — строка с уникальным именем временного файла.</p>
<p>Если аргумент <образец> не задан, то по умолчанию принимается "$VL~~" Если <образец> задает главную часть имени временного файла длиной более пяти символов, то используются только первые пять.</p>
<p>Если аргумент <папка> не задан или задан равным nil, то в качестве папки, в которой предполагается размещение временного файла, принимается папка, вычисляемая по следующему алгоритму:<br>
	папка с именем из аргумента <образец>, если он задан с путем;<br>
	папка, имя которой задано в переменной окружения ТМР;<br>
	папка, имя которой задано в переменной окружения TEMP;<br>
	текущий каталог.</p>
<p>Если аргумент <расширение> не задан, то расширение временного файла извлека¬ется из аргумента <образец> (может оказаться и пустой строкой). Если аргумент <расширение> указан без начальной точки, то его значение добавляется к главной части имени временного файла.
При формировании имени временного файла к главной части имени, извлекаемой из аргумента <образец>, добавляется трехзначный номер, обеспечивающий требуемую уникальность имени.</p>
<p class="h55">Примеры:
</p>
<pre><code> (vl-filename-mktemp) возвращает "С: \\D0CUME~1\\...\\LOCALS~l\\Temp\\$VL~~001"
 (vl-filename-mktemp "abcdefgh") Возвращает "С: \\DOCUME~l\\ ... \\LOCALS-1 \\Temp\\abcde002"
	(vi-filename-mktemp "ххх" "c:\\Temp"  "$хх") возвращает wcr^\Temp\\xxx003$xx"
	(Vl-filename-raktemp "ххх" "c:\\Temp" ".$хх") возвращает "с:\\Тетр\\ххх004.$хх"</code></pre>

<Table Border=0 CellPadding=0 CellSpacing=0 Width=95%>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#800000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Br>
<Tr><Td Valign=ToP><P Class=pr>Замечание:&nbsp;&nbsp;</P></Td>
<Td Valign=Center><P Class=prt> Все файлы с именами, сгенерированными функцией vi-filename-mktemp во время сеанса работы в среде Visual LISP, автоматически удаляются при выходе из Visual LISP.
</P></Td></Tr>

<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#800000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../../../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../../../оболочка/images/raspor.gif Height=1></Td></Tr></Table>

<p class="h3">Функция vl-mkdir
</p>
<p>Создает палку с заданным именем.
<pre><code> (vl-mkdir <имя>)</code></pre>
<p>Тип аргумента — строка.
Возвращаемое значение — т при успешном завершении и nil — при ошибке создания.</p>
<p class="h55">Примеры:
</p>
<pre><code> (vl-mkdir "ABC") возвращает T (создана папка ABC внутри текущего каталога)
	 (vl-mkdir "d:\\Temp14") возвращает Т
	(vi-mkdir "d:\\XYZ\\Temp14") возвращает nil, если папка d:\XYZ не существует</code></pre>
<p class="h3">Функция vl-princ-to-string
</p>
<p>Преобразует в строку любой аргумент, по аналогии с тем, как функция princ выводит данные в файл.
<pre><code> (vl-princ-to-string <аргумент>)</code></pre>
<p>Тип аргумента — любой.
Возвращаемое значение — текстовая строка.</p>
<p class="h55">Примеры:
</p>
<pre><code> (vl-princ-to-string 41) возвращает "41"
 (vl-princ-to-string 'cons) возвращает "cons" ¦  (vl-princ-to-string "Tree") возвращает "Tree"
 (vl-princ-to-string '(12 7 11)) BO3вращает "(12 7 11)"
 (vl-princ-to-string '(0 . "LINE") ) возвращает "(O . LINE)"
 (vl-princ-to-string 5.1234567) возвращает "5.123456" (оставлено шесть значащих цифр)</code></pre>
<p class="h3">Функция vl-prin1 -to-string
</p>
<p>Преобразует в строку любой аргумент, по аналогии с тем, как функция prin1 выводит данные в файл.
<pre><code> (vl-prin1 -to-string <аргумент>)</code></pre>
<p>Тип аргумента — любой.
Возвращаемое значение — текстовая строка
</p><p class="h55">Примеры:</p>
<pre><code> (VL-PRIN1-TO-STGING 41) возвращает M4I"
 (VL-PRIN1-TO-STRING 'cons) возвращает "cons"
 (VL-PRIN1-TO-STRING "TREE") возвращает "\"TREE\""
 (VL-PRIN1-TO-STRING ' (12 7 11)) возвращает " (12 7 11) "
 (VL-PRIN1-TO-STRING '(0 . "LINE")) возвращает " (0 . \"LINE\") "
 (VI-PRIN1-TO-STRING   5.1234567)   возвращает "5.12346" (сохранено только шесть значащих цифр)</code></pre>
<p class="h3">Пример работы с файлами
</p>
<p>Приведенные в предыдущих разделах функции дают пользователю возможность работы только с файлами последовательного доступа. Указателем позиции в файле, с которой далее будет происходить чтение (запись), является переменная хранящая дескриптор этого файла. Механизм работы с файлами отображен в примере, приведенном в листинге.
</p>
<p class="h55">ПРИМЕР ИСПОЛЬЗОВАНИЯ ФУНКЦИЙ РАБОТЫ С ФАЙЛАМИ
</p>
<pre><code> (setq ff (open "d:\\temp.txt" "W"))
 (write-line "Первая строка" ff)
 (write-char 65 ff)
 (write-char 67 ff)
 (write-line "Вторая строка" ff)
 (close ff)
 ; ОПЕРАЦИИ чтения
 (setq ff (open "d:\\temp.txt" "r")) (setq s1 (read-char ff))
 (setq s2 (read-char ff))
 (setq strl (read-line ff))
 (setq str2 (read-line ff))
 (setq str3 (read^line ff))
 (Close ff)
 (setq ff nil)</code></pre>
 <p>
Первое выражение — (setq ff (open "d:\\temp.txt" "W")) — создает переменную ff, в которую заносится дескриптор файла c:\test.txt, открываемого для записи (в первом аргументе функции open обратная косая черта удваивается). Затем выражение (write-line "Первая строка" ff) заносит в открытый файл первую запись (текст "Первая строка" из 13 символов) и символы с кодами 13 и 10, которые в файлах последовательного доступа разделяют записи.</p>
<p>После этого указатель файла показывает на начало второй записи, куда поочередно — с помощью двукратного применения функции write-char— заносятся символы с кодами 65 (буква А) И 67 (буква с). Затем в продолжение второй записи
файла С ПОМОЩЬЮ функции write-line заносится текст "Вторая строка" (13 символов) и добавляются символы с кодами 13 и 10, означающие конец второй записи файла. Вслед за этим файл с дескриптором f f закрывается функцией close.</p>
 <p>Вторая часть листинга начинается функцией открытия того же файла, но уже в режиме чтения. Затем с помощью двукратного применения функций read-chat читаются два первых символа первой записи, которые запоминаются в переменных s1 и s2. После этого в переменную stri читается остаток первой записи. Далее в переменную str2 читается вторая запись файла. Третья операция чтения с помощью функции read-line приносит nil, поскольку в файле d:\temp.txt третьей записи нет. По окончании выполнения рассмотренной программы переменная ff очищается (в ней хранился дескриптор файла). Другие переменные получат такие значения:</p>
<p>s1 = 207 (код символа п)<br>
s2 = 229 (код символа е)<br>
strl = "рвая строка" <br>
str2 = "АСВторая строка" <br>
str3 =  nil</p>
<p>Функции princ, prin1, print и prompt чаще всего применяются для вывода сообщений в командную строку системы AutoCAD, причем prin1 и print выводят сообщения в кавычках (другие особенности описаны выше). Вместо функции write-line для записи в файл можно пользоваться функцией princ, но заносить признак конца записи, который выглядит как "\n", пользователь должен сам. </p>
<p>Например:
<pre><code> (princ "Первая запись\n" ff)</code></pre>




<Hr Width="90%" Color="#7685C6" Align="Right">
<Br>

</Td></Tr></Table>
</Center>

 </Td>
</Tr>
<Tr>
 <Td ColSpan=2>

<Table Border=0 CellSpacing=0 CellPadding=0>
 <Tr>
  <Td BackGround=../../../оболочка/images/b1.gif Width=458 Height=100 Valign=Bottom>
   <P Class=co>Copyright &copy; БГУИР, Кафедра Систем управления, 2015<Br>
   <Img Src=../../../оболочка/images/raspor.gif Width=1 Height=8></P></Td>
  <Td BackGround=../../../оболочка/images/b2.gif Width=159 Height=100>
   <A Href=#Top onMouseOver="mOver(4)" onMouseOut="mOut(4)">
<Img Src=../../../оболочка/images/09a.gif Width=159 Height=46 Border=0 Alt="К началу документа" name="link4"></A><Br>
   <A Href=../../../index.html onMouseOver="mOver(5)" onMouseOut="mOut(5)">
<Img Src=../../../оболочка/images/10a.gif Width=159 Height=54 Border=0 Alt="К первой странице" name="link5"></A></Td>
 </Tr>
</Table>

 </Td>
</Tr>
</Table>

</Body>
</HTML>