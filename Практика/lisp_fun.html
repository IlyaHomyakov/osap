<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>

<Head>
<Meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<Title>Электронный ресурс по учебной дисциплине ОСАПр. Специальные функции</Title>
<Meta Name="Description" http-equiv="description" Content="Электронный ресурс по учебной дисциплине ОСАПр. Специальные функции">
<Link Rel="stylesheet" Type="text/css" Href="../../../Оболочка/acad.css">

<Script>hljs.initHighlightingOnLoad();</Script>

<Script Language="JavaScript">
<!--
	function mOver(num) {if (document.images) {document.images['link'+num].src=eval('active'+num+'.src');}}
	function mOut(num) {if (document.images) {document.images['link'+num].src=eval('normal'+num+'.src');}}
//-->
</Script>
</Head>

<Body Bgcolor=#E6E6E6 TopMargin=1 LeftMargin=1 MarginWidth=0 MarginHeight=0 >
<div class=max>
<Script Language="JavaScript"><!--
if (document.images) {
	normal1=new Image(190,29);normal1.src="../../../Оболочка/images//01a.gif";
	active1=new Image(190,29);active1.src="../../../Оболочка/images//01p.gif";
	normal2=new Image(190,29);normal2.src="../../../Оболочка/images/02a.gif";
	active2=new Image(190,29);active2.src="../../../Оболочка/images/02p.gif";
	normal3=new Image(190,29);normal3.src="../../../Оболочка/images//03a.gif";
	active3=new Image(190,29);active3.src="../../../Оболочка/images//03p.gif";
	normal4=new Image(159,46);normal4.src="../../../Оболочка/images//09a.gif";
	active4=new Image(159,46);active4.src="../../../Оболочка/images//09p.gif";
	normal5=new Image(159,54);normal5.src="../../../Оболочка/images//10a.gif";
	active5=new Image(159,54);active5.src="../../../Оболочка/images//10p.gif";
	normal7=new Image(190,29);normal7.src="../../../Оболочка/images//7a.gif";
	active7=new Image(190,29);active7.src="../../../Оболочка/images//7p.gif";
	normal11=new Image(170,25);normal11.src="../../../Оболочка/images//02_1a.gif";
	active11=new Image(170,25);active11.src="../../../Оболочка/images//02_1p.gif";
	normal12=new Image(170,19);normal12.src="../../../Оболочка/images//02_2a.gif";
	active12=new Image(170,19);active12.src="../../../Оболочка/images//02_2p.gif";
	normal13=new Image(170,19);normal13.src="../../../Оболочка/images//02_3a.gif";
	active13=new Image(170,19);active13.src="../../../Оболочка/images//02_3p.gif";
	normal24=new Image(170,19);normal24.src="../../../Оболочка/images//04a.gif";
	active24=new Image(170,19);active24.src="../../../Оболочка/images//04p.gif";
	normal25=new Image(170,19);normal25.src="../../../Оболочка/images//05a.gif";
	active25=new Image(170,19);active25.src="../../../Оболочка/images//05p.gif";
	normal26=new Image(170,19);normal26.src="../../../Оболочка/images//06a.gif";
	active26=new Image(170,19);active26.src="../../../Оболочка/images//06p.gif";
	normal14=new Image(170,19);normal14.src="../../../Оболочка/images//l1_a.gif";
	active14=new Image(170,19);active14.src="../../../Оболочка/images//l1_p.gif";
	normal15=new Image(170,19);normal15.src="../../../Оболочка/images//z_a.gif";
	active15=new Image(170,19);active15.src="../../../Оболочка/images//z_p.gif";
	normal16=new Image(170,19);normal16.src="../../../Оболочка/images//l2_a.gif";
	active16=new Image(170,19);active16.src="../../../Оболочка/images//l2_p.gif";
	normal17=new Image(170,19);normal17.src="../../../Оболочка/images//z_a.gif";
	active17=new Image(170,19);active17.src="../../../Оболочка/images//z_p.gif";
	normal18=new Image(170,19);normal18.src="../../../Оболочка/images//l3_a.gif";
	active18=new Image(170,19);active18.src="../../../Оболочка/images//l3_p.gif";
	normal19=new Image(170,19);normal19.src="../../../Оболочка/images//z_a.gif";
	active19=new Image(170,19);active19.src="../../../Оболочка/images//z_p.gif";
	normal20=new Image(170,19);normal20.src="../../../Оболочка/images//l4_a.gif";
	active20=new Image(170,19);active20.src="../../../Оболочка/images//l4_p.gif";
	normal21=new Image(170,19);normal21.src="../../../Оболочка/images//z_a.gif";
	active21=new Image(170,19);active21.src="../../../Оболочка/images//z_p.gif";
	normal27=new Image(170,19);normal27.src="../../../Оболочка/images/15a.gif";
	active27=new Image(170,19);active27.src="../../../Оболочка/images/15p.gif";
}
//-->
</Script>

<Left>
<A Name="Top"></A>
<Table Border=0 Width=100% CellSpacing=0 CellPadding=0>
<Tr>
 <Td BackGround=../../../Оболочка/images/bg01.gif Width=190 Height=91 name="link19">&nbsp;</Td>
 <Td Rowspan=2 BackGround=../../../Оболочка/images/bg02_acad.gif Height=120 Valign=Bottom style="background-repeat:no-repeat;">

<Table BackGround=../../../Оболочка/images/raspor.gif Border=0 CellSpacing=0 CellPadding=0>
 <Tr>
  <Td Width=230></Td>
  <Td><P Class=h6>AutoLISP<Br><Img Src=../../../Оболочка/images/raspor.gif Width=1 Height=26></P></Td>
 </Tr>
</Table>

</Td></Tr>
<Tr>
 


<Td BackGround=../../../Оболочка/images/bg03.gif>
 <A Href=../../../Программа/!rabprog.html onMouseOver="mOver(26)" onMouseOut="mOut(26)"><Img Src=../../../Оболочка/images/06a.gif Width=190 Height=29 Border=0 
Alt="Рабочая программа" name="link26"></A><Br></Td>

</Tr>
<Tr>
 <Td BackGround=../../../Оболочка/images/bg09.gif Valign=Top>

<Table Border=0 CellSpacing=0 CellPadding=0>
<Tr><Td BackGround=../../../оболочка/images/bg03.gif Valign=Top>
	<A Href=../../../Теория/!lekcii.html onMouseOver="mOver(7)" onMouseOut="mOut(7)"><Img Src=../../../оболочка/images/7a.gif Width=190 Height=29 Border=0 
Alt="Лекции" name="link7"></A><Br>
 </Td>
 <Tr><Td BackGround=../../../оболочка/images/bg04.gif Width=190 Valign=Top>
 <a href="../../!zadanie.html"> <Img Src=../../../оболочка/images/8p.gif Border=0 Width=190 Height=29 Alt="Лабораторные работы"></a><Br></Td>
<Tr><Td BackGround=../../../оболочка/images/bg05_1.gif Width=190 Valign=Top>
  <A href="../lb1/!acad.html" onMouseOver="mOver(14)" onMouseOut="mOut(14)"><Img Src=../../../оболочка/images/l1_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 1" name="link14"></A><Br></Td></Tr>
<Tr><Td BackGround=../../../оболочка/images/bg06.gif Width=190 Height=36 Valign=Top>
   <A href="../lb1/laba1.html"  onMouseOver="mOver(15)" onMouseOut="mOut(15)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 1" name="link15"></A><Br>
  <A href="../lb2/!mechanic.html" onMouseOver="mOver(18)" onMouseOut="mOut(18)"><Img Src=../../../Оболочка/images/l3_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 2" name="link18"></A><Br>
<A  href="../lb2/laba2.html" onMouseOver="mOver(19)" onMouseOut="mOut(19)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 2" name="link19"></A><Br>
  <A href="../lb2/!mechanic.html" onMouseOver="mOver(20)" onMouseOut="mOut(20)"><Img Src=../../../Оболочка/images/l4_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 3" name="link20"></A><Br>
<A href="../lb3/laba3.html"1 onMouseOver="mOver(21)" onMouseOut="mOut(21)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 3" name="link21"></A><Br>
 <A href="../lb4/!lisp.html" onMouseOver="mOver(16)" onMouseOut="mOut(16)"><Img Src=../../../Оболочка/images/l2_a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 4" name="link16"></A><Br>
<A  href="../lb4/laba4.html" onMouseOver="mOver(17)" onMouseOut="mOut(17)"><Img Src=../../../Оболочка/images/z_a.gif Width=170 Height=20 Border=0 Alt="Задания 4" name="link17"></A><Br>
  <Img Src=../../../Оболочка/images/bg07.gif Width=190 Height=23><Br></Td></Tr>
 <Tr><Td BackGround=../../../оболочка/images/bg03.gif Valign=Top>
   <A Href=../../../Заочнику/!zaochnoe.html onMouseOver="mOver(27)" onMouseOut="mOut(27)"><Img Src=../../../Оболочка/images/15a.gif Width=190 Height=29 Border=0  Alt="Заочнику" name="link27"></A><Br>
  <A Href=../../../Контроль_знаний/!samocontrol.html onMouseOver="mOver(25)" onMouseOut="mOut(25)"><Img Src=../../../оболочка/images/05a.gif Width=190 Height=29 Border=0 
Alt="Самоконтроль" name="link25"></A><Br>
	 <Img Src=../../../оболочка/images/bg08.gif Width=190 Height=13><Br>
</Table></Td>
 <Td Valign=Top>
<P><Br></P>

<Center>
<Table Border=0 CellPadding=0 CellSpacing=0 Width=95%><Tr><Td>

<Br>
<Table Border=0 CellPadding=0 CellSpacing=0>
<Tr><Td Bgcolor=#000000><Img Src=../../../оболочка/images/raspor.gif Height=2></Td>
<Tr><Td Valign=Center Height=30><span Class=h1>Специальные функции</span></Td></Tr>
<Tr><Td Bgcolor=#000000><Img Src=../../../оболочка/images/raspor.gif Height=2></Td></Tr>
</Table></Center><Br>



<P>ИзAutoLISP можно управлять некоторыми режимами графического редактора не обращаясь к функциям AutoCAD. К встроенным функциям AutoLISP, управляющим графическим редактором, можно отнести следующие функции:</P>
<pre><code> (graphscr)</code></pre>

<P>Переключает экран из текстового режима в графический в системах с одним экраном (эквивалентна клавише переключения экрана - F1 на IBM PC).</P>

<pre><code> (textscr)</code></pre>

<P>Переключает экран из графического режима в текстовый в системах с одним экраном (эквивалентна клавише переключения экрана - F1 на IBM PC).</P>

<pre><code> (textpage)</code></pre>

<P>Аналогична функции TEXTSCR за исключением того, что она очищает текстовый экран от любого отображаемого на нем текста.</P>

<pre><code> (redraw [имя_примитива [режим]])</code></pre>

<P>Действие данной функции зависит от количества аргументов. Если аргументов нет, то она перерисовывает текущий видовой экран, как это делает команда AutoCAD REDRAW: если она вызывается с аргументом имя_примитива, то перерисован будет только этот выбранный примитив. Эту функцию часто используют для идентификации примитива на экране после использования функции AutoCAD GRCLEAR. Полный контроль за перерисовкой примитива обеспечивается заданием параметра режим, который может принимать одно из следующих значений:</P>

<Center>
<Table Border="1" CellPadding="2" CellSpacing="1">
 <Tr BgColor="#D1D6E9">
 <Td><P Class=tcb>Режим REDRAW</P></Td>
 <Td><P Class=tcb>Действие</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>1</P></Td>
 <Td><P Class=tl>Перерисовывает примитив на экране</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>2</P></Td>
 <Td><P Class=tl>Не рисует примитив (стирает)</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>3</P></Td>
 <Td><P Class=tl>Подсвечивает примитив (если позволяет дисплей)</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>4</P></Td>
 <Td><P Class=tl>Перестает подсвечивать примитив (если позволяет дисплей)</P></Td>
</Tr>
</Table></Center>

<P>Если имя_примитива - заголовок сложного примитива (полилинии или блока с атрибутами), то в процессе перерисовки будут участвовать как основной примитив, так и все подпримитивы, при условии, что аргумент режим положителен. Если же аргумент режим отрицателен, то в процессе выполнения функции REDRAW будет участвовать только основной примитив. Функция REDRAW всегда возвращает nil.</P>

<pre><code> (grdraw от к цвет [подсветка])</code></pre>

<P>Данная функция рисует вектор между двумя точками на текущем видовом экране. Координаты точек от и к определяют конечные точки отрезка в текущей ПСК. Вектор подрезается до видимой части на экране. Цвет вектора задается целочисленным аргументом цвет. Если это значение равно -1, то цвет дополняет цвет линии, поверх которой он отрисовывается, до цвета фона, что делает данный фрагмент невидимым. Если аргумент подсветка присутствует и не равен нулю, то вектор изображается подсвеченным, как выбранный примитив, если дисплей в состоянии это отобразить. При отсутствии или при нулевом значении этого аргумента используется обычный режим отрисовки.</P>

<pre><code> (grtext [бокс текст [подсветка])</code></pre>

<P>Данная функция обеспечивает доступ к текстовым частям графического экрана AutoCAD. Если аргумент бокс присутствует и равен целому числу в пределах от нуля до наибольшего нумерованного бокса экранного меню минус единица, высвечивается строковый аргумент текст в заданном боксе экранного меню. Если текст не помещается, он усекается. При слишком коротком тексте он дополняется пробелами.</P>
<P>В присутствии подсветки не равной нулю текст подсвечивается. Снять подсветку можно установкой этого значения в нуль. Подсветка другого бокса автоматически снимает подсветку предыдущего. При вставке текста в бокс он сначала должен быть записан без подсветки, а потом его можно подсветить. Для того, чтобы подсветить бокс меню или снять с него подсветку, необходимо указать тот же строковый аргумент текст, который был первоначально записан в этот бокс, но с аргументом подсветка. Заметим, что эта функция только высвечивает указанную строку экранного меню; она не заменяет отмеченных пунктов меню. Более того, на некоторых типах мониторов действие обычной подсветки пункта меню заключается в изменении цвета этого пункта, так что GRTEXT может возвратить текст пункта в предыдущее состояние, если этот пункт меню подсветить. На некоторых мониторах зона меню переписывается при выполнении действий по переключению экрана или при перерисовке экрана командами REDRAW, REGEN. Однако на большинстве мониторов текст функции GRTEXT будет оставаться в зоне экранного меню до тех пор, пока его не перепишет новая страница меню.</P>
<P>Если в функции GRTEXT указать номер бокса равным -1, текст будет записан в статусную строку режимов. Длина статусной строки различна на разных мониторах, в большинстве случаев она составляет 40 символов. При превышении этой длины текст усекается.</P>
<P>Если номер бокса равен -2, текст записывается в строку координат. Если отслеживание координат включено, значения, записанные в этом поле, будут переписываться, как только от устройства указания последуют новые данные о координатах. В двух последних случаях при заданном аргументе подсветка он игнорируется.</P>
<P>Если функцию вызвать без аргументов, текстовые поля экрана придут к стандартному виду.</P>

<pre><code> (grread [отслеживание])</code></pre>

<P>Функция позволяет непосредственно считывать информацию с устройств ввода AutoCAD, отслеживая перемещения устройства указания. Аргумент отслеживание, если он присутствует и не равен nil, дает возможность возвратить координаты от устройств указания в то время, как они движутся, не требуя нажатия кнопки ввода.</P>
<P>GRREAD возвращает список, первый элемент которого - код, указывающий тип устройства или режима ввода.</P>
<P>Коды для первого элемента списка:</P>

<Center>
<Table Border="1" CellPadding="2" CellSpacing="1">
 <Tr BgColor="#D1D6E9">
 <Td><P Class=tcb>Код</P></Td>
 <Td><P Class=tcb>Назначение</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>2</P></Td>
 <Td><P Class=tl>Символ клавиатуры - второй элемент - его ASCII-код</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>3</P></Td>
 <Td><P Class=tl>Выбранная точка - координаты в виде списка</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>4</P></Td>
 <Td><P Class=tl>Выбранная ячейка экранного меню - номер бокса</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>5</P></Td>
 <Td><P Class=tl>Задан режим отслеживание, не равный nil. Второй элемент - координаты режима отслеживания</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>6</P></Td>
 <Td><P Class=tl>Выбран пункт меню BUTTONS - номер кнопки</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>7</P></Td>
 <Td><P Class=tl>Выбран пункт меню TABLET1 - номер бокса</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>8</P></Td>
 <Td><P Class=tl>Выбран пункт меню TABLET2 - номер бокса</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>9</P></Td>
 <Td><P Class=tl>Выбран пункт меню TABLET3 - номер бокса</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>10</P></Td>
 <Td><P Class=tl>Выбран пункт меню TABLET4 - номер бокса</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>11</P></Td>
 <Td><P Class=tl>Выбран пункт меню AUX1 - номер бокса</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>12</P></Td>
 <Td><P Class=tl>Координаты, связанные с кнопкой указателя в качестве второго элемента. Всегда следует за типом 6, возвращает список</P></Td>
</Tr>
</Table></Center>
	

<P>Нажатие клавиши "CTRL С" при выполнении функции GRREAD приведет к прерыванию выполнения LISP-программы. Любой другой ввод будет передаваться непосредственно к функции, предоставляя полный контроль над устройством ввода.</P>
<P>При нажатии кнопки выбора и указания области экранного или падающего меню GRREAD возвращает код 11, но при последующем вызове код 12 не возвращается: код 12 возвращается только после кодов 6 или 11, если кнопка выбора нажата при указании на графическую область экрана.</P>
<P>Важно очищать буфер от данных кода 12 перед выполнением других действий с кнопкой выбора или меню AUX1. Для этого можно выполнить вложенную функцию GRREAD:</P>

<pre><code> (setq code12 (grread (setq code (grread))))</code></pre>

<P>Данная последовательность запоминает значение кода 12 как потоковый ввод с устройства.</P>

<pre><code> (vports)</code></pre>

<P>Возвращает список дескрипторов действующих в настоящий момент видовых экранов. Каждый дескриптор видового экрана - это список, содержащий номер видового экрана и координаты его нижнего левого и правого верхнего углов. Значения координат находятся в интервале от 0.0 до 1.0, где (0.0 0.0) - координаты нижнего левого угла зоны графического экрана, а (1.0 1.0) - координаты ее верхнего правого угла. Дескриптор текущего видового экрана всегда стоит в списке первым.</P>
<P>Таким образом, из программы на AutoLISP можно гибко управлять режимами отображения графического редактора. Но на этом не исчерпывается список ориентированных на систему AutoCAD функций AutoLISP. В AutoLISP есть функции, позволяющие использовать внутренние возможности графического редактора как системы управления графической базой данных. К таким функциям относятся функции объектной привязки и определения различных геометрических параметров объектов, описываемые ниже.</P>

<pre><code> (menucmd строка)</code></pre>

<P>Данная программа представляет механизм листания меню в программах на LISP, что позволяет согласованно работать с загруженными файлами меню, высвечивая соответствующие страницы. MENUCMD всегда возвращает nil. Аргумент строка записывается в следующей форме:</P>

<P Class=h5>раздел=субменю</P>

<P>Раскроем, что имеется в виду под разделом и субменю.</P>

<Center>
<Table Border="1" CellPadding="2" CellSpacing="1">
 <Tr BgColor="#D1D6E9">
 <Td><P Class=tcb>Раздел</P></Td>
 <Td><P Class=tcb>Имя субменю</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>S</P></Td>
 <Td><P Class=tc>SCREEN</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>В1-В4</P></Td>
 <Td><P Class=tc>BUTTONS от 1 до 4</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>I</P></Td>
 <Td><P Class=tc>ICON</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>PI - Р16</P></Td>
 <Td><P Class=tc>(POP) от 1 до 16</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>Tl - Т4</P></Td>
 <Td><P Class=tc>TABLET от 1 до 4</P></Td>
</Tr>
<Tr Bgcolor=#EAEAEA>
 <Td><P Class=tc>Al - A4</P></Td>
 <Td><P Class=tc>AUX от 1 до 4</P></Td>
</Tr>
<Tr Bgcolor=#DCDCDC>
 <Td><P Class=tc>М</P></Td>
 <Td><P Class=tc>Выражения DIESEL</P></Td>
</Tr>
</Table></Center>

<P>Субменю - Указывает, какое субменю активизировать. Именем должна быть либо одна из меток субменю без ** в текущем загруженном файле меню, либо имя одного из разделов меню. Знак S здесь не используется.</P>
<P>Что касается графических и падающих меню, то для них допустимо имя *, которое означает вызов субменю из текущего раздела.</P>



<Hr Width="90%" Color="#7685C6" Align="Right">
<Br>

</Td></Tr></Table>
</Center>

 </Td>
</Tr>
<Tr>
 <Td ColSpan=2>

<Table Border=0 CellSpacing=0 CellPadding=0>
 <Tr>
  <Td BackGround=../../../оболочка/images/b1.gif Width=458 Height=100 Valign=Bottom>
   <P Class=co>Copyright &copy; БГУИР, Кафедра Систем управления, 2015<Br>
   <Img Src=../../../оболочка/images/raspor.gif Width=1 Height=8></P></Td>
  <Td BackGround=../../../оболочка/images/b2.gif Width=159 Height=100>
   <A Href=#Top onMouseOver="mOver(4)" onMouseOut="mOut(4)">
<Img Src=../../../оболочка/images/09a.gif Width=159 Height=46 Border=0 Alt="К началу документа" name="link4"></A><Br>
   <A Href=../../../index.html onMouseOver="mOver(5)" onMouseOut="mOut(5)">
<Img Src=../../../оболочка/images/10a.gif Width=159 Height=54 Border=0 Alt="К первой странице" name="link5"></A></Td>
 </Tr>
</Table>

 </Td>
</Tr>
</Table>

</Body>
</HTML>