<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>

<Head>
<Meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<Title>Электронный ресурс по учебной дисциплине ОСАПр. Написание программ на AutoLISP</Title>
<Meta Name="Description" http-equiv="description" Content="Электронный ресурс по учебной дисциплине ОСАПр. Написание программ на AutoLISP">
<Link Rel="stylesheet" Type="text/css" Href="../Оболочка/acad.css">

<Script>hljs.initHighlightingOnLoad();</Script>

<Script Language="JavaScript">
<!--
function mOver(num) {if (document.images) {document.images['link'+num].src=eval('active'+num+'.src');}}
function mOut(num) {if (document.images) {document.images['link'+num].src=eval('normal'+num+'.src');}}
//-->
</Script>
<style>
	pre{
		width: 43%;
	}
</style>
</Head>

<Body Bgcolor=#E6E6E6 TopMargin=1 LeftMargin=1 MarginWidth=0 MarginHeight=0 >
<div class=max>

<Script Language="JavaScript">
if (document.images) {
normal1=new Image(190,29);normal1.src="../Оболочка/images/01a.gif";
active1=new Image(190,29);active1.src="../Оболочка/images/01p.gif";
normal2=new Image(190,29);normal2.src="../Оболочка/images/02a.gif";
active2=new Image(190,29);active2.src="../Оболочка/images/02p.gif";
normal31=new Image(170,40);normal31.src="../Оболочка/images/031a.gif";
active31=new Image(170,40);active31.src="../Оболочка/images/031p.gif";
normal32=new Image(170,40);normal32.src="../Оболочка/images/032a.gif";
active32=new Image(170,40);active32.src="../Оболочка/images/032p.gif";
normal33=new Image(170,40);normal33.src="../Оболочка/images/033a.gif";
active33=new Image(170,40);active33.src="../Оболочка/images/033p.gif";
normal34=new Image(170,40);normal34.src="../Оболочка/images/034a.gif";
active34=new Image(170,40);active34.src="../Оболочка/images/034p.gif";
normal4=new Image(190,29);normal4.src="../Оболочка/images/04a.gif";
active4=new Image(190,29);active4.src="../Оболочка/images/04p.gif";
normal5=new Image(190,29);normal5.src="../Оболочка/images/05a.gif";
active5=new Image(190,29);active5.src="../Оболочка/images/05p.gif";
normal6=new Image(159,46);normal6.src="../Оболочка/images/06a.gif";
active6=new Image(159,46);active6.src="../Оболочка/images/06p.gif";
normal7=new Image(159,54);normal7.src="../Оболочка/images/07a.gif";
active7=new Image(159,55);active7.src="../Оболочка/images/07p.gif";
}
</Script>

<A Name="Top"></A>
<Table Border=0 Width=100% CellSpacing=0 CellPadding=0>
<Tr>
 <Td BackGround=../Оболочка/images/bg01.gif Width=190 Height=91>&nbsp;</Td>
 <Td RowSpan=2 BackGround=../Оболочка/images/bg02.gif Height=120 Valign=Bottom>
<Table BackGround=../Оболочка/images/raspor.gif Border=0 CellSpacing=0 CellPadding=0>
 <Tr>
<Td Width=180></Td>
  <Td Valign=top Height=75><P Class=h6>AutoLISP</P></Td>
 </Tr>
</Table>

</Td></Tr>
<Tr>
  <Td BackGround=../Оболочка/images/bg03.gif>
    <A Href=../Программа/!rabprog.html onMouseOver="mOver(1)" onMouseOut="mOut(1)"><Img Src=../Оболочка/images/01a.gif Border=0 Width=190 Height=29 Alt="Рабочая программа" name="link1"></A><Br>
 </Td>
</Tr>
<Tr>
 <Td Height=100% RowSpan="2" Valign=Top BackGround=../Оболочка/images/bg00.gif>

<Table Border=0 CellSpacing=0 CellPadding=0>
<Tr><Td BackGround=../Оболочка/images/bg03.gif Valign=Top>
  <A Href=../Теория/!lekcii.html onMouseOver="mOver(2)" onMouseOut="mOut(2)"><Img Src=../Оболочка/images/02a.gif Width=190 Height=29 Border=0 Alt="Лекции" name="link2"></A><Br>
 </Td>
</Tr>
<Tr><Td BackGround=../Оболочка/images/bg04.gif Width=190 Valign=Top>
  <Img Src=../Оболочка/images/03p.gif Border=0 Width=190 Height=29 Alt="Лабораторные работы"><Br></Td>
<Tr><Td BackGround=../Оболочка/images/bg05.gif Width=190 Valign=Top>
  <A href="!acad.html" onMouseOver="mOver(31)" onMouseOut="mOut(31)"><Img Src=../Оболочка/images/031a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 1" name="link31"></A><Br></Td></Tr>
<Tr><Td BackGround=../Оболочка/images/bg06.gif Width=190 Height=36 Valign=Top>
  <A href="!mechanic.html" onMouseOver="mOver(32)" onMouseOut="mOut(32)"><Img Src=../Оболочка/images/032a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 2" name="link32"></A><Br>
  <A href="!mechanic.html" onMouseOver="mOver(33)" onMouseOut="mOut(33)"><Img Src=../Оболочка/images/033a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 3" name="link33"></A><Br>
  <A href="!lisp.html" onMouseOver="mOver(34)" onMouseOut="mOut(34)"><Img Src=../Оболочка/images/034a.gif Width=170 Height=40 Border=0 Alt="Лабораторная работа 4" name="link34"></A><Br>
<Img Src=../Оболочка/images/bg07.gif Width=190 Height=23><Br></Td></Tr>
 
 <Tr><Td BackGround=../Оболочка/images/bg03.gif Valign=Top>
 <A Href=../Заочнику/!zaochnoe.html onMouseOver="mOver(4)" onMouseOut="mOut(4)"><Img Src=../Оболочка/images/04a.gif Width=190 Height=29 Border=0 Alt="Самоконтроль" name="link4"></A><Br>
 <A Href=../Контроль_знаний/!samocontrol.html onMouseOver="mOver(5)" onMouseOut="mOut(5)"><Img Src=../Оболочка/images/05a.gif Width=190 Height=29 Border=0 Alt="Самоконтроль" name="link5"></A><Br>
 <Img Src=../Оболочка/images/bg08.gif Width=190 Height=13><Br>
</Table></Td>
 
 <Td Valign=Сenter>
 <Br><Br>

<Center>
<Table Border=0 CellPadding=0 CellSpacing=0 Width=95%><Tr><Td>

<Br>
<Table Border=0 CellPadding=0 CellSpacing=0>
<Tr><Td Bgcolor=#000000><Img Src=../оболочка/images/raspor.gif Height=2></Td>
<Tr><Td Valign=Center Height=30><span Class=h1>Написание программ на AutoLISP</span></Td></Tr>
<Tr><Td Bgcolor=#000000><Img Src=../оболочка/images/raspor.gif Height=2></Td></Tr>
</Table></Center><Br>

<P>Дла загрузки в память AutoCAD используется команда</P>

<pre><code class="lisp"> (load имя_файла)</code></pre>

<P>записываемая в командной строке. Ввод расширения .lsp не требуется.</P>

<P>Или же можно использовать команду 
<pre><code class="lisp"> appload</code></pre>
</P>

<P>Рассмотрим пример написания простейшей программы. Как известно, в AutoLISP углы измеряются в радианах и могут принимать значения от 0 до
2<Span Style='Font-size:14.0pt; font-family:Symbol;'>p</span> радиан. Поскольку более удобно измерять углы в градусах, создадим новую пользовательскую функцию, преобразующую градусы в радианы. Для этого необходимо наберать её текст в текстовом редакторе и сохранить под именем
myprog.lsp:</P>


<pre><code class="lisp">  ;Преобразование углов из градусов в радианы
 (defun dtr (a)
  (* pi (/ a 180.0))
     )
 (prompt "\nПрограмма загружена - синтаксических ошибок нет!")
 ;Конец программы</code></pre>



<P>Заметим, что строка в тексте программы, начинающаяся с точки с запятой, - это строка комментариев, которая AutoLISP не обрабатывается. Если
точка с запятой стоит не в начале строки, то всё, что после неё,- тоже комментарии. Расположение скобок не играет никакой роли
при интерпретации программы вычислителем AutoLISP, но программа лучше читается, если закрывающие скобки располагаются либо на той же строке,
либо в том же столбце, что и открывающие. Для написания программ на AutoLISP целесообразно использовать текстовый редактор, отслеживающий
парность скобок, а также не вставляющем в файл своих служебных символов. Не рекомендуется для создания программы на AutoLISP использовать текстовые процессоры, такие, как Microsoft Word или CharWriter, поскольку они применяют свой формат файлов, вставляя в них свою служебную информацию, которая не может быть обработана компилятором AutoLISP (конечно, они позволяют выводить набранный документ в так называемом режиме ASCII без форматирования, но их назначение не набор программ, а создание документов).</P>

<P>Сохраните файл с программой на диске и загрузите его в AutoCAD:</P>

<pre><code class="lisp"> Command:(load "myprog")
 AutoLISP возвращает: nil</code></pre>
<P>Здесь load - функция AutoLISP, выполняемая с командной строки AutoCAD. Функция загружает программу из файла в среду AutoCAD - AutoLISP. Указывая ей имя файла, можно не писать расширение: она берёт файлы с расширением .lsp по умолчанию. (Не путайте функцию load AutoLISP с командой LOAD AutoCAD, загружающей файлы чертежей, - это предупреждение относится особенно к тем, кто работает на английской версии AutoCAD.) При загрузке функции AutoLISP читает из файла определение функции, осуществляет синтаксическую проверку и, если ошибок (синтаксических!) нет, сохраняет функцию в области памяти, специально отведённой для пользовательских программ, после чего отображает на экране имя загруженной функции. Всё, что не является определением функции (в нашем случае это подсказка "prompt"), выполняется AutoLISP немедленно. Определенная пользователем функция должна быть вызвана явно.</P>

<P>Теперь можно проверить работу этой функции, вводя разные значения аргументов:</P>

<pre><code class="lisp"> Command:(dtr 180)
 AutoLISP возвращает: 3.141593</code></pre>

<P>Аргументы функции - это имена переменных, которые используются для передачи данных в локальную среду функции. Аргументы функции называются
также формальными параметрами (в отличие от фактических параметров, т.е. тех параметров, которые указываются при вызове функции). В примере а -
формальный параметр, число 180 - фактический. Список фактических параметров должен соответствовать списку формальных параметров, т.е. они
должны иметь одинаковое число элементов, без пропусков и перестановок.</P>
<Table Border=0 CellPadding=0 CellSpacing=0 Width=95%>
<Tr><Td><Img Src=../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#800000><Img Src=../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td Valign=ToP><P Class=pr>Замечание:&nbsp;&nbsp;</P></Td>
<Td Valign=Center><P Class=prt>Автокад не загружает автоматически файл с программой после того, как в него внесены изменения. Это необходимо делать принудительно при помощи меню или функции APPLOAD. В противном случае можно долго искать ошибку: программа исправлена, а работает, как и
прежде.<Tr><Td><Img Src=../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#800000><Img Src=../оболочка/images/raspor.gif Height=1></Td></Tr>
<Tr><Td><Img Src=../оболочка/images/raspor.gif Height=1></Td><Td Bgcolor=#FF0000><Img Src=../оболочка/images/raspor.gif Height=1></Td></Tr></Table>


<P>Для просмотра значения переменной, в командной строке нужно набрать восклицательный знак, а за ним - имя переменной:</P>

<pre><code class="lisp"> Command:</B> !а</code></pre>

<P>выведет на экран значение переменной а.</P><Br>



<Hr Width="90%" Color="#7685C6" Align="Right">
<Br>

</Td></Tr></Table>
</Center>

 </Td>
</Tr>
<Tr>
<Td>&nbsp;</Td>
</Tr>

<Tr>
<Td ColSpan=2>

<Table Border=0 CellSpacing=0 CellPadding=0>
<Tr>
<Td BackGround=../Оболочка/images/bg09.gif Width=458 Height=100 Valign=Bottom>
<P Class=co>Copyright &copy; БГУИР, Кафедра Систем управления, 2017<Br>
<Img Src=../Оболочка/images/raspor.gif Width=1 Height=8></P></Td>
<Td BackGround=../Оболочка/images/bg10.gif Width=159 Height=100>
<A Href=#Top onMouseOver="mOver(6)" onMouseOut="mOut(6)"><Img Src=../Оболочка/images/06a.gif Width=159 Height=46 Border=0 Alt="К началу документа" name="link6"></A><Br>
<A Href=!zadanie.html onMouseOver="mOver(7)" onMouseOut="mOut(7)"><Img Src=../Оболочка/images/07a.gif Width=159 Height=54 Border=0 Alt="К первой странице" name="link7"></A></Td>
</Tr>
</Table>

</Td>
</Tr>
</Table>

</Body>
</HTML>